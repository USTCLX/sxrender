!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.SXRender=i()}(this,function(){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},e=function(){function t(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(i,e,s){return e&&t(i.prototype,e),s&&t(i,s),i}}(),s=function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)},n=function(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i},a=function(t){var i;return i=t.target.getBoundingClientRect(),{x:Math.round(t.clientX-i.x),y:Math.round(t.clientY-i.y)}},r=function(t,i,e){for(var s=null,n=i,a=0,r=t.length;a<r;a++)if(!0===(s=t[a]).draggable)switch(s.type){case p.Circle:if(n.x>s.x+e.x-s.radius&&n.x<s.x+e.x+s.radius&&n.y>s.y+e.y-s.radius&&n.y<s.y+e.y+s.radius)return s.id;break;case p.Rect:if(n.x>s.x+e.x&&n.x<s.x+e.x+s.width&&n.y>s.y+e.y&&n.y<s.y+e.y+s.height)return s.id;break;case p.Image:return s.id;default:return 0}},h=function(t,i){return t>0?(1-1/(.55*t/i+1))*i:(1-1/(.55*-t/i+1))*i},o=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxx".replace(/[xy]/g,function(t){var i=16*Math.random()|0;return("x"===t?i:3&i|8).toString(16)}).toUpperCase()},u=function i(e){var s=void 0;if(null===e||"object"!==(void 0===e?"undefined":t(e)))return e;if(e instanceof Date)return(s=new Date).setTime(e.getTime()),s;if(e instanceof Array){s=[];for(var n=0,a=e.length;n<a;n++)s[n]=i(e[n]);return s}if(e instanceof Object){s={};for(var r in e)e.hasOwnProperty(r)&&(s[r]=i(e[r]));return s}},c=function(t){var i=Object.prototype.toString.call(t);return i.slice(8,i.length-1).toLowerCase()},l="string",f="function",d="array",p={Rect:"SX-Rect",Circle:"SX-Circle",Image:"SX-Image"};function m(t,i){setTimeout(t,i)}var y={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},spring:function(t){return-.5*Math.exp(-6*t)*(-2*Math.exp(6*t)+Math.sin(12*t)+2*Math.cos(12*t))}},g={idle:"idle",running:"running",paused:"paused"},x="number",b="object";function _(t,i,e,s){return s?Math.round(i+e*(t-i)):Math.round(t+e*(i-t))}function v(t,i,e,s){var n=Object.assign({},t);for(var a in n)n.hasOwnProperty(a)&&(n[a]=s?Math.round(i[a]+e*(t[a]-i[a])):Math.round(t[a]+e*(i[a]-t[a])));return n}var w=function(t,i,e,s,n,a){a=a||{},this.target=t,this.key=i,this.startValue=e,this.stopValue=s,this.duration=n,this.fps=a.fps||60,this.startDelay=a.startDelay||0,this.autoReverse=a.autoReverse||!1,this.repeatCount=a.repeatCount||1,this.appliedOnCompletion=a.appliedOnCompletion||function(){},this.timingFun=a.timingFun||y.linear,this.state=new function(t,i,e,s,n){this.stateType=t||g.idle,this.repeat=i||0,this.curFrame=e||0,this.curValue=s,this.reversing=n||!1},this.lastState=null,this.didStartCB=a.didStartCB||function(){},this.onFrameCB=a.onFrameCB||function(){},this.didPauseCB=a.didPauseCB||function(){},this.didStopCB=a.didStopCB||function(){},this._p=0,this._totalFrames=0,this._timeStep=0,this._timeStamp=0,this._lastTimeStamp=0,this._valueType=x,this.init()},O=function t(){this.state.stateType===g.running&&(this._p=this.timingFun(this.state.curFrame/this._totalFrames),this.state.curValue=this._valueType!==b?_(this.startValue,this.stopValue,this._p,this.state.resveringeState):v(this.startValue,this.stopValue,this._p,this.state.resveringeState),this.target&&this.target.hasOwnProperty(this.key)&&(this.target[this.key]=this.state.curValue),this.onFrameCB&&this.onFrameCB(),this.lastState=u(this.state),this._lastTimeStamp=Date.now(),this.state.curFrame<this._totalFrames?m(t.bind(this),this._timeStep):this.autoReverse&&!this.state.resveringeState?(this.state.resveringeState=!0,this.state.curFrame=0,m(t.bind(this),this._timeStep)):this.state.repeat<this.repeatCount-1?(this.state.repeat++,this.state.curFrame=0,this.state.resveringeState=!1,m(t.bind(this),this._timeStep)):(this.state.curValue=this.stopValue,this.stop()),this.state.curFrame++)};w.prototype={constructor:w,init:function(){switch(this._totalFrames=this.duration/1e3*this.fps,this._timeStep=Math.round(1e3/this.fps),t(this.startValue)){case"object":this._valueType=b;break;case"number":this._valueType=x}this.state.curValue=u(this.startValue)},start:function(){this.state.stateType===g.idle&&(this.state.stateType=g.running,setTimeout(function(){this.didStartCB&&this.didStartCB(),this._lastTimeStamp=Date.now(),this.lastState=u(this.state),m(O.bind(this),this._timeStep)}.bind(this),this.startDelay))},stop:function(){this.state.stateType=g.idle,this.state.curValue=0,this.state.curFrame=0,this.state.repeat=0,this.state.resveringeState=!1,this.didStopCB&&this.didStopCB()},pause:function(){this.state.stateType===g.running&&(this.state.stateType=g.paused,this.didPauseCB&&this.didPauseCB())},resume:function(){this.state.stateType===g.paused&&(this.state.stateType=g.running,m(O.bind(this),this._timeStep))}};var S=function(t,i,e,s,n,a,r,h,o){w.apply(this,[t,i,a,r,h]),this.initialVelocity=e||0,this.damping=s||12,this.stiffness=n||180,this.startX=o||0};S.prototype=Object.create(w.prototype);Object.assign(S.prototype,{constructor:S,start:function(){var t,i,e,s,n,a,r,h,o,u,c,l,f,d;this.state.stateType===g.idle&&(this.state.stateType=g.running,this.timingFun=(t=this.damping,i=this.stiffness,e=this.initialVelocity,s=this.startX,d=(f=t)*f-4*i,o=(s||0)-1,u=e,d>0?(d=Math.sqrt(d),c=(u-(a=.5*(-f-d))*o)/((n=.5*(-f+d))-a),l=(u-n*o)/(a-n),function(t){return c*Math.exp(n*t)+l*Math.exp(a*t)+1}):0==d?(l=u-(c=o)*(n=.5*-f),function(t){return(c+l*t)*Math.exp(n*t)+1}):(d=Math.sqrt(-d),c=o,l=(u-(r=.5*-f)*o)/(h=.5*d),function(t){return(c*Math.cos(h*t)+l*Math.sin(h*t))*Math.exp(r*t)+1})),setTimeout(function(){this.didStartCB&&this.didStartCB(),this._timeStamp=Date.now(),m(function t(){this.state.stateType===g.running&&(this._p=this.timingFun(this.state.curFrame/this._totalFrames),0===this.startX?this.state.curValue=this._valueType!==b?_(this.startValue,this.stopValue,this._p):v(this.startValue,this.stopValue,this._p):1===this.startX&&(this.state.curValue=this._p-1),this.target&&this.target.hasOwnProperty(this.key)&&(this.target[this.key]=this.state.curValue),this.onFrameCB&&this.onFrameCB(),this.state.curFrame<this._totalFrames?m(t.bind(this),this._timeStep):(this.state.curValue=this.stopValue,this.didStopCB&&this.didStopCB(),this.stop()),this.state.curFrame++)}.bind(this),this._timeStep)}.bind(this),this.startDelay))}});var V=function(t,i,e,s,n,a){w.apply(this,[t,i,e,s,null,a]),this.amplitude=n,this.init()},C=function(t,i,e,s){if(s===b){var n={};for(var a in t)t.hasOwnProperty(a)&&(n[a]=t[a]-i[a]*Math.exp(-e/500));return n}return t-i*Math.exp(-e/500)};function I(){this._handlers={}}V.prototype=Object.create(w.prototype),Object.assign(V.prototype,{constructor:V,start:function(){this.state.stateType===g.idle&&(this.state.stateType=g.running,setTimeout(function(){this.didStartCB&&this.didStartCB(),this._timeStamp=Date.now(),this._lastTimeStamp=Date.now(),this.lastState=u(this.state),m(function t(){var i=Date.now()-this._timeStamp,e=this.state;if(this.state.stateType===g.running){if(e.curValue=C(this.stopValue,this.amplitude,i,this._valueType),this._valueType===b){var s=0,n=0;for(var a in e.curValue)e.curValue.hasOwnProperty(a)&&(s++,Math.abs(this.stopValue[a]-e.curValue[a])<1&&(n++,e.curValue[a]=this.stopValue[a]));if(n===s)return this.onFrameCB&&this.onFrameCB(),void this.stop()}else if(this._valueType===x&&Math.abs(this.stopValue-e.curValue)<1)return e.curValue=this.stopValue,this.onFrameCB&&this.onFrameCB(),void this.stop();this.onFrameCB&&this.onFrameCB(),this._lastTimeStamp=Date.now(),this.lastState=u(this.state),m(t.bind(this),this._timeStep)}}.bind(this),this._timeStep)}.bind(this),this.startDelay))}}),I.prototype.on=function(t,i,e){void 0===this._handlers[t]&&(this._handlers[t]=[]),c(i)===f&&this._handlers[t].push({h:i,one:!1,ctx:e||this})},I.prototype.once=function(t,i,e){void 0===this._handlers[t]&&(this._handlers[t]=[]),c(i)===f&&this._handlers[t].push({h:i,one:!0,ctx:e||this})},I.prototype.trigger=function(t){if(c(t)===l&&(t={type:t}),t.target||(t.target=this),!t.type)throw new Error("Event object missing 'type' property");if(c(this._handlers[t.type])===d)for(var i=this._handlers,e=0,s=i.length;e<s;e++)i[e].h.call(i[e].ctx,t)},I.prototype.triggerWithCtx=function(t,i){if(c(t)===l&&(t={type:t}),t.target||(t.target=this),!t.type)throw new Error("Event object missing 'type' property");if(c(this._handlers[t.type])===d)for(var e=this._handlers,s=0,n=e.length;s<n;s++)e[s].h.call(i,t)},I.prototype.off=function(t,i){var e;if(c(this._handlers[t])===d)for(var s=0,n=(e=this._handlers[t]).length;s<n;s++)if(e[s].h===i){e.splice(s,1);break}};var k=function(t){function e(t){i(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t=t||{},s.x=t.x||0,s.y=t.y||0,s.width=t.width||0,s.height=t.height||0,s.fill=t.fill||"",s.stroke=t.stroke||"",s.lineWidth=t.lineWidth||1,s.id=t.id||o(),s.draggable=t.draggable||!1,s}return s(e,I),e}(),B=function(t){function e(t){i(this,e);var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return s.type=p.Rect,s}return s(e,k),e}(),j=function(t){function e(t){i(this,e),t=t||{};var s=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return s.radius=t.radius||0,s.type=p.Circle,s}return s(e,k),e}(),P={Rect:function(t){return new B(t)},Circle:function(t){return new j(t)}},T=function(){function t(){i(this,t),this.objects=[]}return e(t,[{key:"addObj",value:function(t){this.objects.push(t)}},{key:"findById",value:function(t){for(var i=this.objects,e=0,s=i.length;e<s;e++)if(i[e].id===t)return i[e]}},{key:"deleteById",value:function(t){for(var i=this.objects,e=0,s=i.length;e<s;e++)if(i[e].id===t)return void i.splice(e,1)}},{key:"getAllObjects",value:function(){return this.objects}}]),t}(),M=function(){function t(e,s,n){i(this,t),this.canvas=e,this.backCanvas=s,this.storage=n,this.objects=this.storage.objects,this.ctx=e.getContext("2d"),this.bgCtx=s.getContext("2d")}return e(t,[{key:"renderAll",value:function(){var t,i,e,s,n,a,r=this.objects;t=this.ctx,i={w:this.canvas.width,h:this.canvas.height},e=(i=i||{}).x||0,s=i.y||0,n=i.w||0,a=i.h||0,t.clearRect(e,s,n,a);for(var h=0,o=r.length;h<o;h++)switch(r[h].type){case p.Rect:F(this.ctx,r[h]);break;case p.Circle:D(this.ctx,r[h]);break;case p.Image:E(this.ctx,r[h]);break;default:console.error("not match type in render all")}}}]),t}();function F(t,i){var e,s,n,a,r;e=i.x,s=i.y,n=i.width,a=i.height,r=i.fill,t.save(),t.fillStyle=r,t.fillRect(e,s,n,a),t.restore()}function D(t,i){var e,s,n,a,r=0*Math.PI,h=2*Math.PI;e=i.x,s=i.y,n=i.radius,a=i.fill,t.save(),t.beginPath(),t.fillStyle=a,t.arc(e,s,n,r,h,!1),t.fill(),t.closePath(),t.restore()}function E(t,i){var e,s,n,a,r,h,o,u,c;e=i.imgObj,s=i.x||0,n=i.y||0,a=i.w,r=i.h,h=i.dx||0,o=i.dy||0,u=i.dw||0,c=i.dh||0,t.save(),u&&c?t.drawImage(e,s,n,a,r,h,o,u,c):a&&r?t.drawImage(e,s,n,a,r):t.drawImage(e,s,n),t.restore()}var X=function(t){var i,e,s,n,a,r,h,o,u;s=(t=t||{}).id||"",n=t.width,a=t.height,r=t.backgroundColor||"",h=t.contentWidth||n,o=t.contentHeight||a,u=t.drawScrollBar||!1,(i=s?document.getElementById(s):document.createElement("canvas")).style.backgroundColor=r||"rgba(0,0,0,0)",i.width=n||500,i.height=a||500,e=i.getContext("2d"),this.init(i,e,h,o,u)};function R(t){if(this.dragging)this.dragging=!1,this.selectObjId=0;else if(this.scratching&&(this.scratching=!1,clearInterval(this._ticker),this.scrollVEnabled||this.scrollHEnabled))if(0!==this.springOffset.y||0!==this.springOffset.x){var i=this;this._animation=new S(null,"",0,12,180,this.springOffset,{x:0,y:0},800),this._animation.onFrameCB=function(){i.springOffset=this.state.curValue,i.render()},this._animation.start()}else{var e={},s={},n=this._contentVelcoity;if(n.y>30||n.y<-30||n.x>30||n.x<-30){e.x=n.x<-30||n.x>30?.8*n.x:0,e.y=n.y<-30||n.y>30?.8*n.y:0,s.x=Math.round(this.contentOffset.x+e.x),s.y=Math.round(this.contentOffset.y+e.y);i=this;this._animation=new V(null,"",this.contentOffset,s,e),this._animation.onFrameCB=function(){var t,e=0,s=0;i.contentOffset=this.state.curValue,((t=i.contentOffset).x>i.limitX.max||t.x<i.limitX.min)&&(t.x=t.x>i.limitX.max?i.limitX.max:i.limitX.min,e=(this.state.curValue.x-this.lastState.curValue.x)/(Date.now()-this._lastTimeStamp)*1e3),(t.y>i.limitY.max||t.y<i.limitY.min)&&(t.y=t.y>i.limitY.max?i.limitY.max:i.limitY.min,s=(this.state.curValue.y-this.lastState.curValue.y)/(Date.now()-this._lastTimeStamp)*1e3),i.render(),(Math.abs(e)>50||Math.abs(s)>50&&(!e||!s))&&(this.stop(),Math.abs(s)>50?(i._animation=new S(null,"",s,20,180,0,0,800,1),i._animation.onFrameCB=function(){i.springOffset.y=this.state.curValue,i.render()},i._animation.didStopCB=function(){i.springOffset.y=this.state.curValue,i.render()},i._animation.start()):Math.abs(e)>50&&(i._animation=new S(null,"",e,20,180,0,0,2e3,1),i._animation.onFrameCB=function(){i.springOffset.x=this.state.curValue,i.render()},i._animation.didStopCB=function(){i.springOffset.x=this.state.curValue,i.render()},i._animation.start()))},this._animation.start()}}}return X.prototype={constructor:X,init:function(t,i,e,s,n){this.canvas=t,this.ctx=i,this.width=t.width,this.height=t.height,this.dragging=!1,this.scratching=!1,this.selectObjId=0,this.contentW=e,this.contentH=s,this.drawScrollBar=n,this.backgroundImg={},this.scrollVEnabled=!!(this.contentH&&this.contentH>this.height),this.scrollHEnabled=!!(this.contentW&&this.contentW>this.width),this.limitX={min:this.width-this.contentW,max:0},this.limitY={min:this.height-this.contentH,max:0},this.mouseDownPos={x:0,y:0},this.springOffset={x:0,y:0},this.contentOffset={x:0,y:0},this.objects=[],this.storage=new T,this.painter=new M(this.canvas,this.ctx,null,null,this.storage),this._animation=null,this._contentVelcoity={y:0,x:0},this._frame={x:0,y:0},this._ticker=null,this._timeStamp=0,this.canvas.addEventListener("mousedown",function(t){var i=a(t);this.selectObjId=r(this.storage.getAllObjects(),i,this.contentOffset),this.mouseDownPos=i,this.selectObjId?this.dragging=!0:(this.scratching=!0,this._animation&&this._animation.stop(),clearInterval(this._ticker),this._contentVelcoity.y=0,this._contentVelcoity.x=0,(this.scrollVEnabled||this.scrollHEnabled)&&(this._timeStamp=Date.now(),this._frame.y=this.mouseDownPos.y,this._frame.x=this.mouseDownPos.x,this._ticker=setInterval(function(){var t,i,e,s;t=Date.now(),i=t-this._timeStamp,this._timeStamp=t,e=this.mouseDownPos.y-this._frame.y,s=1e3*e/(1+i),this._contentVelcoity.y=.8*s+.2*this._contentVelcoity.y,e=this.mouseDownPos.x-this._frame.x,s=1e3*e/(1+i),this._contentVelcoity.x=.8*s+.2*this._contentVelcoity.x,this._frame.y=this.mouseDownPos.y,this._frame.x=this.mouseDownPos.x}.bind(this),50)))}.bind(this),!1),this.canvas.addEventListener("mouseup",R.bind(this),!1),this.canvas.addEventListener("mousemove",function(t){var i,e,s={x:0,y:0};e=a(t),this.dragging?(s.x=e.x-this.mouseDownPos.x,s.y=e.y-this.mouseDownPos.y,this.mouseDownPos.x=e.x,this.mouseDownPos.y=e.y,(i=this.storage.findById(this.selectObjId)).x+=s.x,i.y+=s.y,this.render()):this.scratching&&(this.scrollVEnabled||this.scrollHEnabled)&&(s.x=e.x-this.mouseDownPos.x,s.y=e.y-this.mouseDownPos.y,this.scrollVEnabled&&(s.y<0?this.contentOffset.y<=this.limitY.min?(this.contentOffset.y=this.limitY.min,this.springOffset.y=h(s.y,this.height),console.log("diff.y",s.y,"springOffset.y",this.springOffset.y)):(this.mouseDownPos.y=e.y,this.contentOffset.y+=s.y):this.contentOffset.y>=this.limitY.max?(this.contentOffset.y=this.limitY.max,this.springOffset.y=h(s.y,this.height)):(this.mouseDownPos.y=e.y,this.contentOffset.y+=s.y)),this.scrollHEnabled&&(s.x<0?this.contentOffset.x<=this.limitX.min?(this.contentOffset.x=this.limitX.min,this.springOffset.x=h(s.x,this.width)):(this.mouseDownPos.x=e.x,this.contentOffset.x+=s.x):this.contentOffset.x>=this.limitX.max?(this.contentOffset.x=this.limitX.max,this.springOffset.x=h(s.x,this.width)):(this.mouseDownPos.x=e.x,this.contentOffset.x+=s.x)),this.render())}.bind(this),!1),this.canvas.addEventListener("mouseout",R.bind(this),!1)},drawBackground:function(t){t&&(this.backgroundImg.content=t.imgObj,this.backgroundImg.sx=t.sx||0,this.backgroundImg.sy=t.sy||0,this.backgroundImg.sw=t.sw||0,this.backgroundImg.sh=t.sh||0,this.backgroundImg.dx=t.dx||0,this.backgroundImg.dy=t.dy||0,this.backgroundImg.dw=t.dw||this.width,this.backgroundImg.dh=t.dh||this.height),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.backgroundImg.content&&(this.backgroundImg.sw&&this.backgroundImg.sh?this.ctx.drawImage(this.backgroundImg.content,this.backgroundImg.sx,this.backgroundImg.sy,this.backgroundImg.sw,this.backgroundImg.sh,this.backgroundImg.dx,this.backgroundImg.dy,this.backgroundImg.dw,this.backgroundImg.dh):this.ctx.drawImage(this.backgroundImg.content,this.backgroundImg.dx,this.backgroundImg.dy,this.backgroundImg.dw,this.backgroundImg.dh),this.ctx.restore())},render:function(){this.backgroundImg.content&&this.drawBackground(),this.ctx.setTransform(1,0,0,1,this.contentOffset.x+this.springOffset.x,this.contentOffset.y+this.springOffset.y),this.painter.renderAll(),this.ctx.setTransform(1,0,0,1,0,0),(this.scrollHEnabled||this.scrollVEnabled&&this.drawScrollBar)&&this.drawProgress()},add:function(t){this.storage.addObj(t),this.render()},drawProgress:function(){var t,i,e,s,n;this.scrollVEnabled&&(e=4,s=(s=Math.round(this.height*this.height/this.contentH)-Math.abs(this.springOffset.y))<10?10:s,n=this.springOffset.y<0?this.springOffset.y:0,t=(t=Math.round(-this.contentOffset.y*this.height/this.contentH)-n)>this.height-10?this.height-10:t,i=this.width-e,this.ctx.save(),this.ctx.fillStyle="#888888",this.ctx.fillRect(i,t,e,s),this.ctx.restore()),this.scrollHEnabled&&(e=(e=Math.round(this.width*this.width/this.contentW)-Math.abs(this.springOffset.x))<10?10:e,s=4,t=this.height-s,n=this.springOffset.x<0?this.springOffset.x:0,i=Math.round(-this.contentOffset.x*this.width/this.contentW)-n,this.ctx.save(),this.ctx.fillStyle="#888888",this.ctx.fillRect(i,t,e,s),this.ctx.restore())}},function(t,i,e){t="prototype"in t?t.prototype:t,i="prototype"in i?i.prototype:i;for(var s in i)i.hasOwnProperty(s)&&(e?null!=i[s]:null==t[s])&&(t[s]=i[s])}(X,P,!1),X});